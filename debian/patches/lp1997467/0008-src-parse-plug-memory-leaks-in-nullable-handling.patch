From: =?UTF-8?q?Lukas=20M=C3=A4rdian?= <slyon@ubuntu.com>
Subject: src:parse: plug memory leaks in nullable handling

This patch fixes a memory leak introduced by https://github.com/canonical/netplan/pull/299

Origin: upstream, https://github.com/canonical/netplan/commit/102f189e8f3a1828a3beddf686dcc96c15a3b9b5
Bug-Ubuntu: https://bugs.launchpad.net/netplan/+bug/1997467
---
 src/parse.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/parse.c b/src/parse.c
index a66b018..4d85318 100644
--- a/src/parse.c
+++ b/src/parse.c
@@ -3456,6 +3456,7 @@ netplan_parser_load_nullable_fields(NetplanParser* npp, int input_fd, GError** e
         npp->null_fields = g_hash_table_new_full(g_str_hash, g_str_equal, g_free, g_free);
 
     extract_null_fields(&doc, yaml_document_get_root_node(&doc), npp->null_fields, g_strdup(""), NULL);
+    yaml_document_delete(&doc);
     return TRUE;
 }
 
@@ -3486,5 +3487,6 @@ netplan_parser_load_nullable_overrides(
      * yaml patch: "network.renderer=NetworkManager"
      * => network.renderer: hint.yaml */
     extract_null_fields(&doc, yaml_document_get_root_node(&doc), npp->null_overrides, g_strdup(""), constraint);
+    yaml_document_delete(&doc);
     return TRUE;
 }
-- 
2.39.1

